function R(t,e){let r=t.length;if(r!==e.length)return!1;for(let a=0;a<r;a++)if(t[a]!==e[a])return!1;return!0}const u=t=>typeof t=="function",g=t=>typeof t=="object",E=null,H=[!0,1,"","1","true"];function I(t,e,r,a,n){let{type:o,reflect:s,event:d,value:p,attr:l=D(e)}=g(r)&&r!=E?r:{type:r},i=!(o==Function||o==E);Object.defineProperty(t,e,{set(f){let m=this[e],{error:b,value:h}=L(o,i&&u(f)?f(m):f);if(b&&h!=null)throw{message:`The value defined for prop '${e}' must be of type '${o.name}'`,value:h,target:this};if(m==h)return;this._props[e]=h,this.update(),this.updated.then(()=>{d&&M(this,d),s&&(this._ignoreAttr=l,B(this,o,l,this[e]),this._ignoreAttr=null)})},get(){return this._props[e]}}),p!=null&&(n[e]=p),a[l]=e}const M=(t,{type:e,...r})=>t.dispatchEvent(new CustomEvent(e,r)),D=t=>t.replace(/([A-Z])/g,"-$1").toLowerCase(),B=(t,e,r,a)=>a==null||e==Boolean&&!a?t.removeAttribute(r):t.setAttribute(r,g(a)?JSON.stringify(a):e==Boolean?"":a);function L(t,e){if(t==E)return{value:e};try{if(t==Boolean?e=H.includes(e):typeof e=="string"&&(e=t==Number?Number(e):t==Object||t==Array?JSON.parse(e):e),{}.toString.call(e)==`[object ${t.name}]`)return{value:e,error:t==Number&&Number.isNaN(e)}}catch(r){}return{value:e,error:!0}}const y={};function S(){return N((t={current:y.ref.host})=>t)}function N(t,e){return y.ref.use(t,e)}function F(){return y.ref.render}function q(t,e){let r={},a={use:s,load:o,updated:d},n={use:s,host:e,render:t};function o(p,l){y.index=0,y.ref=n;let i=p(l);return y.ref=0,i}function s(p,l){let i=y.index++;return r[i]=[p(r[i]?r[i][0]:void 0),l],r[i][0]}function d(p){for(let l in r){let i=r[l];i[1]&&(i[0]=i[1](i[0],p))}}return a}const U={id:1,className:1,checked:1,value:1,selected:1},$={list:1,type:1,size:1,form:1,width:1,height:1,src:1},O={},C=[],x=3,v=document,j=Symbol(),T=Symbol(),J=Symbol();function Y(t,e,...r){let a=e||O;return r=_(a.children||r,t=="style"),r.length||(r=C),{vdom:j,type:t,props:a,children:r,key:a.key,shadow:a.shadowDom,raw:t instanceof Node}}function A(t,e,r=J,a){let n;if(e&&e[r]&&e[r].vnode==t)return e;if(t&&t.type&&t.vdom!=j)return e;if((t!=null||!e)&&(a=a||t.type=="svg",n=t.type!="host"&&(t.raw?e!=t.type:e?e.localName!=t.type:!e),n)){let i;if(t.type!=null)i=t.raw?t.type:a?v.createElementNS("http://www.w3.org/2000/svg",t.type):v.createElement(t.type,t.is?{is:t.is}:null);else return v.createTextNode(t+"");e=i}if(e.nodeType==x){if(!t.raw){let i=t+"";e.data!=i&&(e.data=i||"")}return e}let o=e[r]?e[r].vnode:O,s=o.props||O,d=o.children||C,p=n||!e[r]?{}:e[r].handlers,l=e[r]&&e[r].childNodes;if(t.shadow&&(e.shadowRoot||e.attachShadow({mode:"open"})),t.props!=s&&K(e,s,t.props,p,a),t.children!=d){let i=t.shadow?e.shadowRoot:e;l=z(t.children,l||[],i,r,a&&t.type=="foreignObject"?!1:a)}return e[r]={vnode:t,handlers:p,childNodes:l},e}function z(t,e,r,a,n){let o=t._,s=t.length,d=e.length,p=o?0:d>s?s:d,l=[],i=e[a];for(i||(i=r.appendChild(v.createTextNode(""))),l[a]=i;p<d;p++){let f=e[p];if(o){let m=f[T];if(o.has(m)){o.set(m,f);continue}}e.splice(p,1),p--,d--,f.remove()}for(let f=0;f<s;f++){let m=t[f],b=e[f],h=o?m.key:f,c=o?o.get(h):b;if(o&&c&&(c!=b&&r.insertBefore(c,b)),o&&m.key==null)continue;let w=A(m,c,a,n);c?w!=c&&r.replaceChild(w,c):r.insertBefore(w,e[f]||i),l.push(w)}return l}function K(t,e,r,a,n){for(let o in e)o in r||k(t,o,e[o],null,n,a);for(let o in r)k(t,o,e[o],r[o],n,a)}function k(t,e,r,a,n,o){if(e=e=="class"&&!n?"className":e,r=r??null,a=a??null,e in t&&U[e]&&(r=t[e]),a===r||e=="shadowDom")return;if(e[0]=="o"&&e[1]=="n"&&(u(a)||u(r)))W(t,e,a,o);else if(e=="key")t[T]=a;else if(e=="ref")a&&(a.current=t);else if(e=="style"){let s=t.style;r=r||"",a=a||"";let d=g(r),p=g(a);if(d)for(let l in r)if(p)l in a||P(s,l,null);else break;if(p)for(let l in a){let i=a[l];if(d&&r[l]===i)continue;P(s,l,i)}else s.cssText=a}else!n&&!$[e]&&e in t||u(a)||u(r)?t[e]=a??"":a==null?t.removeAttribute(e):t.setAttribute(e,g(a)?JSON.stringify(a):a)}function W(t,e,r,a){e=e.slice(e[2]=="-"?3:2),a.handleEvent||(a.handleEvent=n=>a[n.type].call(t,n)),r?(a[e]||t.addEventListener(e,a),a[e]=r):a[e]&&(t.removeEventListener(e,a),delete a[e])}function P(t,e,r){let a="setProperty";r==null&&(a="removeProperty",r=null),~e.indexOf("-")?t[a](e,r):t[e]=r}function _(t,e,r=[]){for(let a=0;a<t.length;a++){let n=t[a];if(n){if(Array.isArray(n)){_(n,e,r);continue}n.key!=null&&(r._||(r._=new Map),r._.set(n.key,0))}let o=typeof n;n=n==null||o=="boolean"||o=="function"||o=="object"&&(n.vdom!=j||e)?"":n,e?r[0]=(r[0]||"")+n:r.push(n)}return r}async function X(t,e){let r=Symbol(),a=q(()=>t.update(),t),n;t.symbolId=r,t.update=async()=>{if(!n){n=!0;let o;t.updated=new Promise(s=>o=s).then(a.updated),await t.mounted,A(a.load(e,{...t._props}),t,r),n=!1,o()}},await t.unmounted,a.updated(!0)}function Z(t,e=HTMLElement){let r={},a={},{props:n}=t;class o extends e{constructor(){super();this._props={},this.mounted=new Promise(s=>this.mount=s),this.unmounted=new Promise(s=>this.unmount=s),X(this,t);for(let s in a)this[s]=a[s];this.update()}connectedCallback(){this.mount()}disconnectedCallback(){this.unmount()}attributeChangedCallback(s,d,p){if(s===this._ignoreAttr||d===p)return;this[r[s]]=p}}for(let s in n)I(o.prototype,s,n[s],r,a);return o.observedAttributes=Object.keys(r),o}function G(t){let e=F();return N((r=[])=>(r[1]||(r[0]=u(t)?t():t,r[1]=a=>{a=u(a)?a(r[0]):a,a!=r[0]&&(r[0]=a,e())}),r))}function Q(t,e){N(([r,a]=[])=>((a||!a)&&(a&&R(a,e)?r=r||!0:(u(r)&&r(),r=null)),[r,e]),([r,a],n)=>{if(n)u(r)&&r();else return[r||t(a),a]})}export{Q as a,S as b,Z as c,Y as h,G as u};
