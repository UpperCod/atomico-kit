{"version":3,"file":"use-stylesheet.showcase.js","sources":["../src/hooks/use-stylesheet/use-stylesheet.js","../src/hooks/use-stylesheet/use-stylesheet.showcase.js"],"sourcesContent":["import { useHost, useEffect } from \"atomico\";\n\nlet cache = {};\nlet support = document.adoptedStyleSheets;\n\n/**\n * Add support to styleSheet, only in browsers that\n * implement it, it is remembered that adoptedStyleSheets\n * (05/13/2020) is not standard of the w3 is just a\n * valid implementation for google crhome\n * @param  {...(string|CSSStyleSheet)} stylesheet\n */\nexport function useStylesheet(...stylesheet) {\n  let ref = useHost();\n  let { current } = ref;\n\n  useEffect(() => {\n    if (support) {\n      ref.prev = ref.prev || [];\n      let shadowRootPrev = current.shadowRoot.adoptedStyleSheets.filter(\n        (styleSheet) => !ref.prev.includes(styleSheet)\n      );\n      ref.prev = stylesheet.map((css) => {\n        if (typeof css == \"string\" && !cache[css]) {\n          let sheet = new CSSStyleSheet();\n          sheet.replace(css);\n          cache[css] = sheet;\n        }\n        return cache[css] || css;\n      });\n\n      current.shadowRoot.adoptedStyleSheets = [...shadowRootPrev, ...ref.prev];\n    }\n  }, stylesheet);\n\n  return support ? \"\" : stylesheet.join(\"\");\n}\n","import { h, customElement, useState } from \"atomico\";\r\nimport { useStylesheet } from \"./use-stylesheet\";\r\nexport { render } from \"atomico\";\r\n\r\nconst Example1 = ({ src }) => {\r\n  let [state, setState] = useState(0);\r\n  let stylesText = useStylesheet(\r\n    `:host{color:red}`,\r\n    `:host{background:rgba(0,0,0,.${state})}`\r\n  );\r\n  return (\r\n    <host shadowDom>\r\n      <style>{stylesText}</style>\r\n      <h1>Is the text red?</h1>\r\n      <button onclick={() => setState(state + 1 > 10 ? 0 : state + 1)}>\r\n        update : {state}\r\n      </button>\r\n    </host>\r\n  );\r\n};\r\n\r\nExample1.props = {\r\n  src: String,\r\n};\r\n\r\ncustomElement(\"use-stylesheet-example-1\", Example1);\r\n\r\nexport default [\r\n  {\r\n    label: \"Example useStylesheet\",\r\n    render() {\r\n      return (\r\n        <host>\r\n          <use-stylesheet-example-1></use-stylesheet-example-1>\r\n        </host>\r\n      );\r\n    },\r\n  },\r\n];\r\n"],"names":["cache","support","document","adoptedStyleSheets","useStylesheet","stylesheet","ref","useHost","current","useEffect","prev","shadowRootPrev","shadowRoot","filter","styleSheet","includes","map","css","sheet","CSSStyleSheet","replace","join","Example1","src","state","setState","useState","stylesText","h","props","String","customElement","label","render"],"mappings":";;;AAEA,IAAIA,KAAK,GAAG,EAAZ;AACA,IAAIC,OAAO,GAAGC,QAAQ,CAACC,kBAAvB;AAEA;;;;;;;;AAOO,SAASC,aAAT,CAAuB,GAAGC,UAA1B,EAAsC;AAC3C,MAAIC,GAAG,GAAGC,CAAO,EAAjB;AACA,MAAI;AAAEC,IAAAA;AAAF,MAAcF,GAAlB;AAEAG,EAAAA,CAAS,CAAC,MAAM;AACd,QAAIR,OAAJ,EAAa;AACXK,MAAAA,GAAG,CAACI,IAAJ,GAAWJ,GAAG,CAACI,IAAJ,IAAY,EAAvB;AACA,UAAIC,cAAc,GAAGH,OAAO,CAACI,UAAR,CAAmBT,kBAAnB,CAAsCU,MAAtC,CAClBC,UAAD,IAAgB,CAACR,GAAG,CAACI,IAAJ,CAASK,QAAT,CAAkBD,UAAlB,CADE,CAArB;AAGAR,MAAAA,GAAG,CAACI,IAAJ,GAAWL,UAAU,CAACW,GAAX,CAAgBC,GAAD,IAAS;AACjC,YAAI,OAAOA,GAAP,IAAc,QAAd,IAA0B,CAACjB,KAAK,CAACiB,GAAD,CAApC,EAA2C;AACzC,cAAIC,KAAK,GAAG,IAAIC,aAAJ,EAAZ;AACAD,UAAAA,KAAK,CAACE,OAAN,CAAcH,GAAd;AACAjB,UAAAA,KAAK,CAACiB,GAAD,CAAL,GAAaC,KAAb;AACD;;AACD,eAAOlB,KAAK,CAACiB,GAAD,CAAL,IAAcA,GAArB;AACD,OAPU,CAAX;AASAT,MAAAA,OAAO,CAACI,UAAR,CAAmBT,kBAAnB,GAAwC,CAAC,GAAGQ,cAAJ,EAAoB,GAAGL,GAAG,CAACI,IAA3B,CAAxC;AACD;AACF,GAjBQ,EAiBNL,UAjBM,CAAT;AAmBA,SAAOJ,OAAO,GAAG,EAAH,GAAQI,UAAU,CAACgB,IAAX,CAAgB,EAAhB,CAAtB;AACD;;AChCD,MAAMC,QAAQ,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAa;AAC5B,MAAI,CAACC,KAAD,EAAQC,QAAR,IAAoBC,CAAQ,CAAC,CAAD,CAAhC;AACA,MAAIC,UAAU,GAAGvB,aAAa,CAC3B,kBAD2B,EAE3B,gCAA+BoB,KAAM,IAFV,CAA9B;AAIA,SACEI;AAAM,IAAA,SAAS;AAAf,KACEA,iBAAQD,UAAR,CADF,EAEEC,iCAFF,EAGEA;AAAQ,IAAA,OAAO,EAAE,MAAMH,QAAQ,CAACD,KAAK,GAAG,CAAR,GAAY,EAAZ,GAAiB,CAAjB,GAAqBA,KAAK,GAAG,CAA9B;AAA/B,kBACYA,KADZ,CAHF,CADF;AASD,CAfD;;AAiBAF,QAAQ,CAACO,KAAT,GAAiB;AACfN,EAAAA,GAAG,EAAEO;AADU,CAAjB;AAIAC,CAAa,CAAC,0BAAD,EAA6BT,QAA7B,CAAb;AAEA,6BAAe,CACb;AACEU,EAAAA,KAAK,EAAE,uBADT;;AAEEC,EAAAA,MAAM,GAAG;AACP,WACEL,gBACEA,mCADF,CADF;AAKD;;AARH,CADa,CAAf;;;;"}