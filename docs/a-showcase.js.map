{"version":3,"file":"a-showcase.js","sources":["../src/utils.js","../src/hooks/use-event-move/use-event-move.js","../src/components/a-showcase/a-showcase.js"],"sourcesContent":["export const isUrl = file => /^(http(s){0,1}:){0,1}\\/\\//.test(file);\r\n","import { useState } from \"atomico\";\r\n\r\nlet globalHandlerCancel = [\r\n  \"touchend\",\r\n  \"mouseup\",\r\n  \"mouseleave\",\r\n  \"touchleave\",\r\n  \"click\"\r\n];\r\nlet globalHandlerCapture = [\"mousemove\", \"touchmove\"];\r\n\r\nfunction addEventListener(type, handler) {\r\n  window.addEventListener(type, handler);\r\n}\r\n\r\nfunction removeEventListener(type, handler) {\r\n  window.removeEventListener(type, handler);\r\n}\r\n\r\nexport function getSwipe(range, duration = 500, space = 100) {\r\n  let length = range.length;\r\n  let first = range[0];\r\n  let last = range[length - 1];\r\n  let [x, y] = range.reduce(([x, y], step) => [(x += step.x), (y += step.y)], [\r\n    0,\r\n    0\r\n  ]);\r\n  let ms = last.t - first.t;\r\n  if (ms < duration) {\r\n    let xD = first.x - last.x;\r\n\r\n    let dir = xD > 0 ? \"toRight\" : \"toLeft\";\r\n\r\n    if (Math.abs(xD) > 60) {\r\n      let yM = y / length;\r\n\r\n      let yMMax = yM + space / 2;\r\n      let yMMin = yM - space / 2;\r\n\r\n      let validZoneY = [first, last].every(({ y }) => y <= yMMax && y >= yMMin);\r\n      if (validZoneY) {\r\n        return dir;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n *\r\n * @param {ObserverEventMove} callback\r\n */\r\nexport function useEventMove(callback) {\r\n  let [ref] = useState(() => {\r\n    function dispath(...args) {\r\n      return ref.callback(...args);\r\n    }\r\n    function startCapture(event) {\r\n      ref.capture = [];\r\n      globalHandlerCancel.forEach(type => addEventListener(type, endCapture));\r\n      globalHandlerCapture.forEach(type => addEventListener(type, capture));\r\n      capture(event, true);\r\n      dispath(\"start\", ref.capture);\r\n    }\r\n    function endCapture(event) {\r\n      if (!ref.capture) return;\r\n      capture(event, false);\r\n      let { capture: currentCapture } = ref;\r\n      ref.capture = false;\r\n      globalHandlerCancel.forEach(type =>\r\n        removeEventListener(type, endCapture)\r\n      );\r\n      globalHandlerCapture.forEach(type => removeEventListener(type, capture));\r\n      dispath(\"end\", currentCapture);\r\n    }\r\n    function capture(event, ignoreEmit) {\r\n      if (!ref.capture) return;\r\n      let x;\r\n      let y;\r\n\r\n      if (/touch/.test(event.type)) {\r\n        let touch = event.touches[0];\r\n        if (!touch) return;\r\n        x = touch.clientX;\r\n        y = touch.clientY;\r\n      } else {\r\n        x = event.clientX;\r\n        y = event.clientY;\r\n      }\r\n      ref.capture.push({ x, y, t: event.timeStamp });\r\n\r\n      if (!ignoreEmit) dispath(\"move\", ref.capture);\r\n    }\r\n\r\n    return {\r\n      slide: -1,\r\n      events: {\r\n        startCapture\r\n      }\r\n    };\r\n  });\r\n\r\n  ref.callback = callback;\r\n\r\n  return {\r\n    ref,\r\n    ontouchstart: ref.events.startCapture,\r\n    onmousedown: ref.events.startCapture\r\n  };\r\n}\r\n\r\n/**\r\n * @callback ObserverEventMove\r\n * @param {\"start\"|\"end\"|\"move\"} type - states associated with event capture\r\n * @param {Array.<{x:number,y:number,t:number}>} range - useful range of the associated movement\r\n * @return {{ref:{}}}\r\n */\r\n","import {\n  h,\n  useRef,\n  useHost,\n  useState,\n  useEffect,\n  customElement,\n} from \"atomico\";\nimport { isUrl } from \"../../utils\";\nimport { useLazy } from \"../../hooks/use-lazy/use-lazy\";\nimport { useEventMove } from \"../../hooks/use-event-move/use-event-move\";\nimport style from \"./a-showcase.css\";\n\nconst AShowcase = ({ src, width, height, origin }) => {\n  const refSandbox = useRef();\n  const refPreview = useRef();\n  const refHeader = useRef();\n  const refHost = useHost();\n\n  let [select, setSelect] = useState();\n\n  let currentZone;\n\n  const propsMove = useEventMove((type, range) => {\n    if (type == \"start\") {\n      currentZone = refHost.current.getBoundingClientRect();\n    }\n    if (type == \"move\") {\n      const last = range[range.length - 1];\n      const move = last.x - currentZone.x;\n      const minWidth = refHeader.current\n        ? refHeader.current.clientWidth + 22\n        : 50;\n      const width =\n        ((move < minWidth ? minWidth : move) / currentZone.width) * 100;\n\n      refPreview.current.style.width =\n        (width > 100 ? 100 : width < 0 ? 0 : width) + \"%\";\n    }\n  });\n\n  const [lazyState, lazyResult] = useLazy(\n    () =>\n      import((isUrl(src) ? \"\" : \"./\") + src).then((md) => ({ default: md })),\n    true\n  );\n\n  const lazyStateIsDone = lazyState == \"done\";\n\n  const cases = lazyStateIsDone ? [].concat(lazyResult.default) : [];\n\n  select = select || (lazyStateIsDone && cases[0].label);\n\n  useEffect(() => {\n    const { render, rendered } =\n      cases.find(({ label }) => label == select) || {};\n    render && lazyResult.render(render(), refSandbox.current);\n    rendered && rendered(refSandbox.current);\n  }, [lazyStateIsDone, select]);\n\n  return (\n    <host shadowDom style={{ width, height }}>\n      <style>{style}</style>\n\n      {lazyStateIsDone && (\n        <header ref={refHeader} class=\"showcase -header\">\n          <select\n            class=\"showcase -select\"\n            onchange={({ target: { value } }) => setSelect(value)}\n          >\n            {cases.map(({ label }) => (\n              <option value={label}>{label}</option>\n            ))}\n          </select>\n          {origin && (\n            <a class=\"showcase -btn\" href={origin} target=\"_blank\">\n              <svg\n                height=\"14\"\n                viewBox=\"0 0 467.765 467.765\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n              >\n                <path d=\"M146.175 87.707L0 233.883l146.175 146.175 41.34-41.34L82.681 233.883l104.834-104.836zM321.59 87.707l-41.34 41.34 104.834 104.836L280.25 338.717l41.34 41.34 146.175-146.175z\" />\n              </svg>\n            </a>\n          )}\n        </header>\n      )}\n\n      <section class=\"showcase -preview\" ref={refPreview}>\n        <div class=\"showcase -sandbox\" ref={refSandbox}></div>\n        <button class=\"showcase -resize\" {...propsMove}></button>\n      </section>\n    </host>\n  );\n};\n\nAShowcase.props = {\n  width: {\n    type: String,\n  },\n  height: {\n    type: String,\n  },\n  src: {\n    type: String,\n  },\n  centered: {\n    type: Boolean,\n    reflect: true,\n  },\n  origin: String,\n};\n\nexport default customElement(\"a-showcase\", AShowcase);\n"],"names":["isUrl","file","test","globalHandlerCancel","globalHandlerCapture","addEventListener","type","handler","window","removeEventListener","useEventMove","callback","ref","useState","dispath","args","startCapture","event","capture","forEach","endCapture","currentCapture","ignoreEmit","x","y","touch","touches","clientX","clientY","push","t","timeStamp","slide","events","ontouchstart","onmousedown","AShowcase","src","width","height","origin","refSandbox","useRef","refPreview","refHeader","refHost","useHost","select","setSelect","currentZone","propsMove","range","current","getBoundingClientRect","last","length","move","minWidth","clientWidth","style","lazyState","lazyResult","useLazy","then","md","default","lazyStateIsDone","cases","concat","label","useEffect","render","rendered","find","h","target","value","map","props","String","centered","Boolean","reflect","customElement"],"mappings":"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"}